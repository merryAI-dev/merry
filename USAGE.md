# VC 투자 분석 에이전트 사용 가이드

## 🚀 빠른 시작

### 1. 환경 설정

```bash
# Python 3.12 가상환경 생성 및 활성화
python3.12 -m venv venv
source venv/bin/activate

# 패키지 설치
pip install -r requirements.txt
```

### 2. API 키 설정

`.env` 파일을 생성하고 Anthropic API 키를 설정:

```bash
echo "ANTHROPIC_API_KEY=your-key-here" > .env
```

---

## 💬 웹 UI 사용 (추천!)

**가장 편한 방법**입니다. 브라우저에서 파일을 드래그&드롭하고 한글로 대화하세요.

```bash
source venv/bin/activate
streamlit run app.py
```

그러면 브라우저가 자동으로 열립니다 (`http://localhost:8501`)

### 웹 UI 기능

1. **파일 업로드**: 사이드바에서 투자검토 엑셀 파일 드래그&드롭
2. **대화**: 자연어로 질문하세요
   - "이 파일 분석해줘"
   - "2030년 PER 10배, 20배, 30배로 Exit 프로젝션 생성해줘"
   - "IRR은 얼마야?"
3. **빠른 명령어**: 사이드바 버튼으로 원클릭 실행
4. **모델 선택**: Opus 4.5 또는 Sonnet 4 선택
5. **대화 초기화**: 새로운 분석 시작

---

## 🖥️ CLI 사용 (터미널)

### 대화형 모드

```bash
source venv/bin/activate
python cli.py chat
```

한글 입력이 불편할 수 있으니 **웹 UI 추천**!

### 빠른 파일 분석

```bash
python cli.py analyze <엑셀파일경로>
```

### 연결 테스트

```bash
python cli.py test
```

---

## 📊 사용 예시

### 예시 1: 엑셀 파일 분석

**웹 UI:**
1. 파일 업로드
2. 채팅: `이 파일을 분석해줘`

**CLI:**
```bash
python cli.py analyze Valuation_비사이드미_202511.xlsx
```

### 예시 2: Exit 프로젝션 생성

**웹 UI:**
1. 파일 업로드
2. 채팅: `2030년 PER 10배, 20배, 30배로 Exit 프로젝션을 만들어줘`

또는 사이드바의 "📈 Exit 프로젝션" 버튼 클릭!

### 예시 3: 맞춤형 분석

**웹 UI:**
```
2028년 기준으로 다음 시나리오를 분석해줘:
- PER 10배
- PER 15배
- PER 20배

그리고 각 시나리오별 IRR과 멀티플을 계산해줘
```

에이전트가 자동으로:
1. 엑셀 파일 읽기
2. 2028년 순이익 추출
3. 각 PER 배수로 기업가치 계산
4. IRR, 멀티플 계산
5. Exit 프로젝션 엑셀 생성

---

## 🎯 핵심 기능

### 1. 유연한 엑셀 분석
- 엑셀 구조가 다양해도 자동으로 이해
- 투자조건, 순이익, 주식수 자동 추출

### 2. 다양한 시나리오
- PER, EV/Revenue, EV/EBITDA 등 모든 밸류에이션 방법
- 전체 매각, 부분 매각, SAFE 전환, 콜옵션 분석

### 3. Exit 프로젝션 자동 생성
- 연도, PER 배수, 회사명 지정
- 전문적인 엑셀 파일 자동 생성 (색상 코드 포함)

---

## 🤖 에이전트가 할 수 있는 것

- ✅ 투자검토 엑셀 파일 자동 분석
- ✅ 다양한 연도/배수의 Exit 시나리오 계산
- ✅ IRR, 멀티플, 기업가치 계산
- ✅ SAFE 전환, 콜옵션, 지분 희석 분석
- ✅ 맞춤형 Exit 프로젝션 엑셀 생성
- ✅ 복잡한 시나리오도 자연어로 요청 가능

---

## 📁 출력 파일

Exit 프로젝션 엑셀은 현재 디렉토리에 생성됩니다:
- 파일명: `exit_projection_YYYYMMDD_HHMMSS.xlsx`
- 위치: 프로젝트 루트

웹 UI 사용 시 에이전트가 파일 경로를 알려줍니다.

---

## ❓ 문제 해결

### API 키 오류
```
❌ ANTHROPIC_API_KEY가 설정되지 않았습니다
```

→ `.env` 파일에 API 키를 설정하세요

### 엑셀 파일을 읽지 못함
```
❌ 엑셀 파일 읽기 실패
```

→ 파일 경로를 확인하세요 (절대 경로 또는 프로젝트 루트 기준 상대 경로)

### 웹 UI가 열리지 않음

```bash
# 수동으로 브라우저 열기
open http://localhost:8501
```

---

## 🎨 웹 UI 스크린샷

### 메인 화면
- 깔끔한 채팅 인터페이스
- 파일 드래그&드롭
- 빠른 명령어 버튼

### 사이드바
- 파일 업로드
- 모델 선택
- 대화 초기화
- 컨텍스트 정보
- 빠른 명령어

---

## 🚀 다음 단계

웹 UI로 시작해보세요:

```bash
source venv/bin/activate
streamlit run app.py
```

그리고 투자검토 엑셀 파일을 업로드한 후:

```
이 파일을 2030년 PER 10배, 20배, 30배로 분석해줘!
```

끝! 🎉
